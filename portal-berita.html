<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Koperasi News Portal</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Emoji Picker CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/emoji-picker-element@1.12.0/dist/index.css">
    <style>
        /* THEME FUTURISTIK DENGAN GRADASI KOPERASI LEMBUT */
        :root {
            --primary-gradient: linear-gradient(135deg, #2A9D8F 0%, #1D6F7D 100%);
            --secondary-gradient: linear-gradient(135deg, #E9C46A 0%, #F4A261 100%);
            --accent-gradient: linear-gradient(135deg, #E76F51 0%, #D65C40 100%);
            --bg-gradient: linear-gradient(135deg, #F8F9FA 0%, #E9ECEF 100%);
            --card-gradient: linear-gradient(145deg, #FFFFFF 0%, #F8F9FA 100%);
            --text-primary: #264653;
            --text-secondary: #457B9D;
            --text-light: #6C757D;
            --border-color: #E0E0E0;
            --shadow-light: rgba(0, 0, 0, 0.08);
            --shadow-medium: rgba(0, 0, 0, 0.12);
            --success: #2A9D8F;
            --warning: #E9C46A;
            --danger: #E76F51;
            --card-radius: 16px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg-gradient);
            font-family: "Poppins", sans-serif;
            color: var(--text-primary);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        /* Efek latar belakang gradasi lembut */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 10% 20%, rgba(42, 157, 143, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(233, 196, 106, 0.05) 0%, transparent 20%);
            z-index: -1;
            pointer-events: none;
        }

        /* TOMBOL ADMIN PANEL */
        .admin-panel-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--accent-gradient);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(231, 111, 81, 0.3);
            text-decoration: none;
        }

        .admin-panel-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(231, 111, 81, 0.4);
        }

        /* CONTAINER UTAMA */
        #news-portal {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            width: 100%;
        }

        /* HEADER */
        .portal-header {
            background: var(--primary-gradient);
            border-radius: var(--card-radius);
            padding: 40px 30px;
            margin: 20px 0 30px 0;
            box-shadow: 0 10px 30px var(--shadow-medium);
            color: white;
            position: relative;
            overflow: hidden;
            width: 100%;
        }

        .portal-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="white" opacity="0.1"/></svg>');
            pointer-events: none;
        }

        .header-content {
            position: relative;
            z-index: 2;
            text-align: center;
            width: 100%;
        }

        .header-content h1 {
            font-size: 3.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            letter-spacing: -0.5px;
            word-wrap: break-word;
        }

        .header-content p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 20px;
            word-wrap: break-word;
        }

        .header-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
            width: 100%;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 12px 24px;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            flex-shrink: 0;
        }

        /* DROPDOWN KATEGORI */
        .filter-bar {
            background: var(--card-gradient);
            border-radius: var(--card-radius);
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px var(--shadow-light);
            border: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            width: 100%;
        }

        .filter-left {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
            width: 100%;
        }

        .dropdown-container {
            position: relative;
            min-width: 200px;
        }

        .dropdown-btn {
            padding: 12px 20px;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            width: 100%;
        }

        .dropdown-btn:hover {
            border-color: var(--success);
        }

        .dropdown-btn.active {
            border-color: var(--success);
            box-shadow: 0 0 0 3px rgba(42, 157, 143, 0.1);
        }

        .dropdown-content {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            margin-top: 5px;
            box-shadow: 0 10px 30px var(--shadow-medium);
            z-index: 100;
            display: none;
            overflow: hidden;
        }

        .dropdown-content.show {
            display: block;
        }

        .dropdown-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-item:hover {
            background: rgba(42, 157, 143, 0.05);
        }

        .dropdown-item.active {
            background: var(--primary-gradient);
            color: white;
        }

        .search-box {
            position: relative;
            flex: 1;
            min-width: 250px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            font-family: "Poppins", sans-serif;
            transition: var(--transition);
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--success);
            box-shadow: 0 0 0 3px rgba(42, 157, 143, 0.1);
        }

        .search-box i {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
        }

        /* GRID BERITA */
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
            width: 100%;
        }

        /* KARTU BERITA PROFESIONAL */
        .news-card {
            background: var(--card-gradient);
            border-radius: var(--card-radius);
            overflow: hidden;
            box-shadow: 0 8px 25px var(--shadow-light);
            transition: var(--transition);
            position: relative;
            border: 1px solid var(--border-color);
            height: 420px;
            display: flex;
            flex-direction: column;
            width: 100%;
        }

        .news-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px var(--shadow-medium);
        }

        .card-image {
            height: 200px;
            overflow: hidden;
            position: relative;
            width: 100%;
        }

        .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
        }

        .news-card:hover .card-image img {
            transform: scale(1.05);
        }

        .category-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--primary-gradient);
            color: white;
            padding: 6px 15px;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
        }

        .card-content {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            width: 100%;
        }

        .card-content h3 {
            font-size: 1.3rem;
            margin-bottom: 10px;
            line-height: 1.4;
            color: var(--text-primary);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            word-wrap: break-word;
        }

        .card-content p {
            color: var(--text-light);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 15px;
            flex-grow: 1;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            word-wrap: break-word;
        }

        .external-source {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: var(--success);
            font-size: 0.85rem;
            margin-top: 5px;
        }

        .card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: auto;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
            width: 100%;
        }

        .card-date {
            color: var(--text-light);
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .read-more {
            color: var(--success);
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: var(--transition);
        }

        .read-more:hover {
            gap: 10px;
        }

        /* MODAL ARTIKEL DETAIL - FULL SCREEN */
        .article-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 0;
        }

        .modal-content {
            background: white;
            border-radius: 0;
            width: 100%;
            height: 100%;
            overflow-y: auto;
            position: relative;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            padding: 20px 30px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary-gradient);
            color: white;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .modal-header h2 {
            font-size: 1.8rem;
            margin-right: 20px;
            flex-grow: 1;
            word-wrap: break-word;
            line-height: 1.4;
        }

        .close-modal {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            font-size: 1.2rem;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            flex-shrink: 0;
        }

        .close-modal:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .close-modal::before,
        .close-modal::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 2px;
            background: white;
            border-radius: 1px;
        }

        .close-modal::before {
            transform: rotate(45deg);
        }

        .close-modal::after {
            transform: rotate(-45deg);
        }

        .modal-body {
            padding: 30px;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .article-image {
            width: 100%;
            height: 500px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .article-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
        }

        .article-category {
            background: var(--primary-gradient);
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .article-date {
            color: var(--text-light);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .article-content {
            line-height: 1.8;
            color: var(--text-primary);
            margin-bottom: 50px;
            font-size: 1.1rem;
            width: 100%;
        }

        .article-content p {
            margin-bottom: 25px;
            word-wrap: break-word;
        }

        .article-content h3 {
            color: var(--text-primary);
            margin: 30px 0 15px 0;
            font-size: 1.5rem;
            word-wrap: break-word;
        }

        .article-source {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: #f0f7ff;
            border-radius: 8px;
            color: #1D6F7D;
            font-size: 0.9rem;
            margin: 20px 0;
            text-decoration: none;
        }

        .article-source:hover {
            background: #e1f0ff;
        }

        /* SISTEM REACTIONS DI MODAL */
        .article-reactions {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 40px;
            padding: 25px;
            background: #F8F9FA;
            border-radius: 12px;
            flex-wrap: wrap;
            width: 100%;
        }

        .reaction-options {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .reaction-btn {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 50px;
            padding: 10px 20px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.1rem;
        }

        .reaction-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-color: var(--success);
        }

        .reaction-btn.active {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
        }

        .reaction-count {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-light);
            font-size: 1rem;
        }

        /* SISTEM KOMENTAR STYLE SOSIAL MEDIA */
        .comments-section {
            margin-top: 50px;
            padding-top: 30px;
            border-top: 1px solid var(--border-color);
            width: 100%;
        }

        .comments-section h3 {
            margin-bottom: 25px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4rem;
        }

        /* Input Komentar Style Instagram/Facebook */
        .comment-input-area {
            margin-bottom: 30px;
        }

        .comment-input-wrapper {
            display: flex;
            gap: 10px;
            align-items: flex-start;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            flex-shrink: 0;
        }

        .comment-input-container {
            flex: 1;
            position: relative;
        }

        .comment-input {
            width: 100%;
            min-height: 50px;
            padding: 12px 50px 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 25px;
            font-family: "Poppins", sans-serif;
            resize: none;
            transition: var(--transition);
            background: #F8F9FA;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .comment-input:focus {
            outline: none;
            border-color: var(--success);
            background: white;
            box-shadow: 0 0 0 3px rgba(42, 157, 143, 0.1);
        }

        .comment-input::placeholder {
            color: var(--text-light);
        }

        .comment-input-actions {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            gap: 8px;
            align-items: center;
        }

        .emoji-toggle, .send-comment {
            background: none;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .emoji-toggle {
            font-size: 1.4rem;
            color: var(--text-light);
        }

        .emoji-toggle:hover {
            color: var(--success);
            transform: scale(1.1);
        }

        .send-comment {
            color: var(--success);
            font-size: 1.2rem;
            opacity: 0.7;
        }

        .send-comment:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .send-comment.active {
            opacity: 1;
            color: var(--success);
        }

        .emoji-picker-container {
            position: absolute;
            bottom: 50px;
            right: 0;
            z-index: 100;
            display: none;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            border-radius: 12px;
            overflow: hidden;
            width: 350px;
        }

        .emoji-picker-container.show {
            display: block;
        }

        /* Daftar Komentar Style Social Media */
        .comments-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-height: 600px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .comment-item {
            display: flex;
            gap: 12px;
            align-items: flex-start;
            padding: 0;
            border-radius: 0;
            border: none;
            background: transparent;
            position: relative;
        }

        .comment-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--primary-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .comment-content {
            flex: 1;
            background: #F8F9FA;
            padding: 12px 15px;
            border-radius: 18px;
            position: relative;
            max-width: calc(100% - 48px);
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
            flex-wrap: wrap;
            gap: 8px;
        }

        .comment-author {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.95rem;
        }

        .comment-time {
            font-size: 0.8rem;
            color: var(--text-light);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .comment-text {
            color: var(--text-primary);
            line-height: 1.5;
            margin-bottom: 8px;
            font-size: 0.95rem;
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        .comment-actions {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-top: 8px;
        }

        .reply-btn, .delete-btn, .like-btn {
            background: none;
            border: none;
            color: var(--text-light);
            cursor: pointer;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: var(--transition);
            padding: 4px 8px;
            border-radius: 4px;
        }

        .reply-btn:hover {
            color: var(--success);
            background: rgba(42, 157, 143, 0.1);
        }

        .delete-btn:hover {
            color: var(--danger);
            background: rgba(231, 111, 81, 0.1);
        }

        .like-btn:hover {
            color: #E4405F;
            background: rgba(228, 64, 95, 0.1);
        }

        .like-btn.liked {
            color: #E4405F;
            font-weight: 600;
        }

        /* PAGINATION */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 50px 0;
            flex-wrap: wrap;
            width: 100%;
        }

        .page-btn {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .page-btn:hover {
            border-color: var(--success);
            color: var(--success);
            transform: translateY(-2px);
        }

        .page-btn.active {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
        }

        .page-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-btn.disabled:hover {
            transform: none;
            border-color: var(--border-color);
            color: inherit;
        }

        /* FOOTER */
        .portal-footer {
            background: var(--primary-gradient);
            color: white;
            padding: 40px 30px;
            border-radius: var(--card-radius);
            margin-top: 50px;
            text-align: center;
            width: 100%;
        }

        .footer-content {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        .footer-logo {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            word-wrap: break-word;
        }

        .copyright {
            margin-top: 30px;
            opacity: 0.8;
            font-size: 0.9rem;
        }

        /* RESPONSIVE DESIGN */
        @media (max-width: 1200px) {
            .news-grid {
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            }
            
            .modal-body {
                padding: 25px;
            }
            
            #news-portal {
                padding: 20px;
            }
        }

        @media (max-width: 992px) {
            .header-content h1 {
                font-size: 2.5rem;
            }
            
            .filter-bar {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }
            
            .filter-left {
                flex-direction: column;
                gap: 15px;
            }
            
            .dropdown-container, .search-box {
                width: 100%;
            }
            
            .news-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 25px;
            }
            
            .article-image {
                height: 400px;
            }
            
            .emoji-picker-container {
                width: 300px;
                right: -50px;
            }
        }

        @media (max-width: 768px) {
            .admin-panel-btn {
                top: 10px;
                right: 10px;
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .portal-header {
                padding: 30px 20px;
                margin-top: 60px;
            }
            
            .header-content h1 {
                font-size: 2rem;
                padding: 0 10px;
            }
            
            .header-stats {
                gap: 15px;
                padding: 0 10px;
            }
            
            .stat-item {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .news-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .modal-header {
                padding: 15px 20px;
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .modal-header h2 {
                font-size: 1.5rem;
            }
            
            .close-modal {
                width: 36px;
                height: 36px;
                position: absolute;
                top: 15px;
                right: 15px;
            }
            
            .close-modal::before,
            .close-modal::after {
                width: 18px;
                height: 2px;
            }
            
            .modal-body {
                padding: 20px;
            }
            
            .article-image {
                height: 300px;
            }
            
            .article-meta {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .article-reactions {
                flex-direction: column;
                align-items: flex-start;
                gap: 20px;
                padding: 20px;
            }
            
            .reaction-options {
                justify-content: center;
                width: 100%;
            }
            
            .reaction-btn {
                padding: 8px 16px;
                font-size: 1rem;
            }
            
            .comments-list {
                max-height: 500px;
            }
            
            .comment-content {
                max-width: calc(100% - 48px);
            }
            
            .emoji-picker-container {
                width: 280px;
                right: -80px;
            }
        }

        @media (max-width: 480px) {
            #news-portal {
                padding: 15px;
            }
            
            .header-content h1 {
                font-size: 1.8rem;
            }
            
            .header-content p {
                font-size: 1rem;
                padding: 0 10px;
            }
            
            .filter-bar {
                padding: 15px;
            }
            
            .dropdown-btn, .search-box input {
                padding: 10px 15px 10px 40px;
            }
            
            .search-box i {
                left: 15px;
            }
            
            .page-btn {
                width: 40px;
                height: 40px;
                font-size: 0.9rem;
            }
            
            .reaction-options {
                justify-content: space-between;
                width: 100%;
            }
            
            .reaction-btn {
                flex: 1;
                justify-content: center;
                min-width: 70px;
            }
            
            .comment-input-wrapper {
                gap: 8px;
            }
            
            .user-avatar {
                width: 36px;
                height: 36px;
                font-size: 0.9rem;
            }
            
            .comment-input {
                font-size: 0.9rem;
                padding: 10px 45px 10px 12px;
            }
            
            .comment-content {
                padding: 10px 12px;
            }
            
            .comment-avatar {
                width: 32px;
                height: 32px;
                font-size: 0.85rem;
            }
            
            .emoji-picker-container {
                width: 250px;
                right: -100px;
                bottom: 60px;
            }
        }

        @media (max-width: 360px) {
            .header-content h1 {
                font-size: 1.6rem;
            }
            
            .stat-item {
                padding: 8px 16px;
                font-size: 0.85rem;
            }
            
            .news-card {
                height: 400px;
            }
            
            .card-image {
                height: 180px;
            }
            
            .card-content h3 {
                font-size: 1.2rem;
            }
            
            .card-content p {
                font-size: 0.9rem;
            }
            
            .emoji-picker-container {
                width: 220px;
                right: -120px;
            }
        }

        /* SCROLLBAR STYLING */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--success);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #1D6F7D;
        }

        /* LOADING ANIMATION */
        .loading {
            text-align: center;
            padding: 50px;
            color: var(--text-light);
            width: 100%;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid var(--border-color);
            border-top-color: var(--success);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ANIMASI UNTUK INTERAKSI */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .new-comment {
            animation: fadeIn 0.3s ease;
        }

        .pulse-animation {
            animation: pulse 0.3s ease;
        }
    </style>
</head>
<body>
    <!-- TOMBOL ADMIN PANEL -->
    <a href="admin-editor.html" class="admin-panel-btn">
        <i class="fas fa-user-cog"></i> Admin Panel
    </a>

    <div id="news-portal">
        <!-- HEADER -->
        <header class="portal-header">
            <div class="header-content">
                <h1><i class="fas fa-newspaper"></i> Koperasi News</h1>
                <p>Berita & Kegiatan Terbaru koperasi Asmara Tani</p>
                <div class="header-stats">
                    <div class="stat-item">
                        <i class="fas fa-newspaper"></i> <span id="total-articles">0</span> Artikel
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-comments"></i> <span id="total-comments">0</span> Komentar
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-eye"></i> <span id="total-views">0</span> Dilihat
                    </div>
                </div>
            </div>
        </header>

        <!-- FILTER BAR DENGAN DROPDOWN -->
        <div class="filter-bar">
            <div class="filter-left">
                <div class="dropdown-container">
                    <button class="dropdown-btn" id="category-dropdown">
                        <span id="selected-category">
                            <i class="fas fa-filter"></i> Pilih Kategori
                        </span>
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="dropdown-content" id="category-list">
                        <div class="dropdown-item active" data-category="all">
                            <i class="fas fa-globe"></i> Semua Kategori
                        </div>
                        <div class="dropdown-item" data-category="rat">
                            <i class="fas fa-chart-line"></i> RAT
                        </div>
                        <div class="dropdown-item" data-category="ekonomi">
                            <i class="fas fa-money-bill-wave"></i> Ekonomi
                        </div>
                        <div class="dropdown-item" data-category="teknologi">
                            <i class="fas fa-microchip"></i> Teknologi
                        </div>
                        <div class="dropdown-item" data-category="pendidikan">
                            <i class="fas fa-graduation-cap"></i> Pendidikan
                        </div>
                        <div class="dropdown-item" data-category="program">
                            <i class="fas fa-gavel"></i> Program
                        </div>
                        <div class="dropdown-item" data-category="sosial">
                            <i class="fas fa-user"></i> Sosial
                        </div>
                        <div class="dropdown-item" data-category="kegiatan">
                            <i class="fas fa-calendar-alt"></i> Kegiatan Koperasi
                        </div>
                    </div>
                </div>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-input" placeholder="Cari artikel...">
                </div>
            </div>
        </div>

        <!-- GRID BERITA -->
        <div class="news-grid" id="news-container">
            <!-- Berita akan dimuat di sini -->
        </div>

        <!-- LOADING INDICATOR -->
        <div class="loading" id="loading-indicator">Memuat artikel...</div>

        <!-- PAGINATION -->
        <div class="pagination" id="pagination-container">
            <!-- Pagination akan dibuat secara dinamis -->
        </div>

        <!-- MODAL ARTIKEL DETAIL -->
        <div class="article-modal" id="article-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="modal-title"></h2>
                    <button class="close-modal" onclick="closeModal()">
                        <!-- X icon dibuat dengan CSS pseudo elements -->
                    </button>
                </div>
                <div class="modal-body" id="modal-body-content">
                    <!-- Konten artikel akan dimuat di sini -->
                </div>
            </div>
        </div>

        <!-- FOOTER -->
        <footer class="portal-footer">
            <div class="footer-content">
                <div class="footer-logo">Koperasi News</div>
                <p>Berita resmi yang menyajikan informasi terkini seputar perkembangan koperasi "Asmara Tani"</p>
                <div class="copyright">
                    Copyright ¬© 2026 Koperasi Asmara Tani . Hak Cipta Dilindungi.
                </div>
            </div>
        </footer>
    </div>

    <!-- Emoji Picker Script -->
    <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@1.12.0/dist/index.js"></script>
    
    <script>
        // Konfigurasi
        const ARTICLES_PER_PAGE = 9;
        let currentPage = 1;
        let currentCategory = 'all';
        let currentSearch = '';
        let articles = [];
        let filteredArticles = [];
        let currentReplyTo = null;
        let currentReplyAuthor = null;
        let currentArticleId = null;
        
        // Data reaksi default
        const defaultReactions = {
            'like': 0,
            'laugh': 0,
            'wow': 0,
            'sad': 0,
            'angry': 0
        };

        // Inisialisasi
        document.addEventListener('DOMContentLoaded', function() {
            // Load artikel dari localStorage
            loadArticlesFromStorage();
            
            // Setup event listeners
            setupEventListeners();
            
            // Setup dropdown kategori
            setupCategoryDropdown();
            
            // Update statistik
            updateStats();
            
            // Sembunyikan loading indicator
            setTimeout(() => {
                document.getElementById('loading-indicator').style.display = 'none';
            }, 1000);
            
            // Listen untuk perubahan dari admin panel
            setupStorageListener();
        });

        // Setup event listeners
        function setupEventListeners() {
            // Search input
            document.getElementById('search-input').addEventListener('input', function(e) {
                currentSearch = e.target.value.toLowerCase();
                filterAndDisplayArticles();
            });
            
            // Close modal dengan ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });
            
            // Close modal dengan klik di luar
            document.getElementById('article-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeModal();
                }
            });
        }

        // Setup listener untuk perubahan dari admin
        function setupStorageListener() {
            window.addEventListener('storage', function(event) {
                if (event.key === 'koperasi_news_articles') {
                    console.log('Artikel diperbarui dari admin panel');
                    loadArticlesFromStorage();
                    updateStats();
                    
                    // Tampilkan notifikasi
                    showNotification('Artikel telah diperbarui!');
                }
            });
        }

        // Tampilkan notifikasi
        function showNotification(message) {
            // Hapus notifikasi sebelumnya jika ada
            const existingNotification = document.querySelector('.update-notification');
            if (existingNotification) {
                existingNotification.remove();
            }
            
            // Buat notifikasi baru
            const notification = document.createElement('div');
            notification.className = 'update-notification';
            notification.innerHTML = `
                <div style="
                    position: fixed;
                    top: 20px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: var(--primary-gradient);
                    color: white;
                    padding: 15px 30px;
                    border-radius: 50px;
                    box-shadow: 0 5px 20px rgba(0,0,0,0.2);
                    z-index: 10000;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    animation: fadeInUp 0.3s ease;
                ">
                    <i class="fas fa-sync-alt"></i>
                    ${message}
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Hapus notifikasi setelah 3 detik
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(-50%) translateY(-20px)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Setup dropdown kategori
        function setupCategoryDropdown() {
            const dropdownBtn = document.getElementById('category-dropdown');
            const dropdownContent = document.getElementById('category-list');
            const dropdownItems = dropdownContent.querySelectorAll('.dropdown-item');
            
            // Toggle dropdown
            dropdownBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                dropdownContent.classList.toggle('show');
                dropdownBtn.classList.toggle('active');
                
                // Rotate icon
                const icon = this.querySelector('.fa-chevron-down');
                icon.style.transform = dropdownContent.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0)';
            });
            
            // Pilih kategori
            dropdownItems.forEach(item => {
                item.addEventListener('click', function() {
                    const category = this.getAttribute('data-category');
                    
                    // Update selected item
                    dropdownItems.forEach(i => i.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Update button text
                    const icon = this.querySelector('i').cloneNode(true);
                    const text = this.textContent.trim();
                    document.getElementById('selected-category').innerHTML = '';
                    document.getElementById('selected-category').appendChild(icon);
                    document.getElementById('selected-category').appendChild(document.createTextNode(' ' + text));
                    
                    // Filter artikel
                    filterCategory(category);
                    
                    // Tutup dropdown
                    dropdownContent.classList.remove('show');
                    dropdownBtn.classList.remove('active');
                    const chevronIcon = dropdownBtn.querySelector('.fa-chevron-down');
                    chevronIcon.style.transform = 'rotate(0)';
                });
            });
            
            // Tutup dropdown ketika klik di luar
            document.addEventListener('click', function(e) {
                if (!dropdownBtn.contains(e.target) && !dropdownContent.contains(e.target)) {
                    dropdownContent.classList.remove('show');
                    dropdownBtn.classList.remove('active');
                    const icon = dropdownBtn.querySelector('.fa-chevron-down');
                    icon.style.transform = 'rotate(0)';
                }
            });
        }

        // Load artikel dari localStorage
        function loadArticlesFromStorage() {
            const storedArticles = localStorage.getItem('koperasi_news_articles');
            
            if (storedArticles) {
                articles = JSON.parse(storedArticles);
                console.log('Artikel dimuat dari localStorage:', articles.length, 'artikel');
            } else {
                // Load artikel sample jika tidak ada data
                console.log('Tidak ada artikel di localStorage, memuat artikel sample');
                loadSampleArticles();
                saveArticlesToStorage();
            }
            
            // Urutkan artikel berdasarkan tanggal (terbaru pertama)
            articles.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // Load reaksi dari localStorage
            loadReactionsFromStorage();
            
            // Load komentar dari localStorage
            loadCommentsFromStorage();
            
            // Tampilkan artikel
            filterAndDisplayArticles();
        }

        // Load artikel sample
        function loadSampleArticles() {
            articles = [
                {
                    id: 1,
                    title: "Transformasi Digital Koperasi di Era 4.0",
                    category: "teknologi",
                    image: "https://images.unsplash.com/photo-1551434678-e076c223a692?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    sourceUrl: "https://example.com/sumber-berita",
                    content: `<p>Transformasi digital telah menjadi kebutuhan mendesak bagi koperasi di Indonesia. Dengan mengadopsi teknologi terkini, koperasi dapat meningkatkan efisiensi operasional, memperluas jangkauan layanan, dan memberikan nilai lebih kepada anggotanya.</p>
                             <h3>Manfaat Transformasi Digital</h3>
                             <p>Implementasi sistem digital dalam koperasi tidak hanya sebatas pada proses administrasi, tetapi juga mencakup pengembangan platform digital untuk pelayanan anggota, sistem pembayaran digital, hingga analisis data untuk pengambilan keputusan strategis.</p>
                             <h3>Hasil yang Dicapai</h3>
                             <p>Beberapa koperasi terkemuka telah berhasil menerapkan transformasi digital dengan hasil yang signifikan. Mereka mencatat peningkatan kinerja hingga 40% dalam hal efisiensi operasional dan kepuasan anggota.</p>`,
                    date: "2024-03-15",
                    author: "Admin Koperasi",
                    views: 0,
                    reactions: { ...defaultReactions },
                    comments: [
                        {
                            id: 101,
                            author: "Pengunjung",
                            text: "Artikel yang sangat informatif! üëç",
                            timestamp: "2024-03-15T10:30:00Z",
                            likes: 0,
                            liked: false,
                            replies: [
                                {
                                    id: 102,
                                    author: "Member Aktif",
                                    text: "Setuju! Teknologi memang penting untuk koperasi. üòä",
                                    timestamp: "2024-03-15T11:15:00Z",
                                    likes: 0,
                                    liked: false
                                }
                            ]
                        },
                        {
                            id: 103,
                            author: "Pembaca Setia",
                            text: "Kapan ada pelatihan digital untuk koperasi? ü§î",
                            timestamp: "2024-03-15T12:45:00Z",
                            likes: 0,
                            liked: true
                        }
                    ]
                },
                {
                    id: 2,
                    title: "Strategi Pengembangan Keuangan Koperasi Berkelanjutan",
                    category: "ekonomi",
                    image: "https://images.unsplash.com/photo-1554224155-6726b3ff858f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    sourceUrl: "https://example.com/sumber-berita-keuangan",
                    content: `<p>Pengembangan keuangan yang berkelanjutan menjadi kunci keberhasilan koperasi dalam jangka panjang. Strategi yang tepat dapat memastikan pertumbuhan yang stabil dan manfaat yang optimal bagi seluruh anggota.</p>
                             <h3>Strategi Efektif</h3>
                             <p>Beberapa strategi yang efektif meliputi diversifikasi produk keuangan, penguatan modal internal, kerjasama dengan lembaga keuangan formal, dan penerapan prinsip kehati-hatian dalam pengelolaan dana.</p>
                             <h3>Ketahanan Ekonomi</h3>
                             <p>Koperasi yang menerapkan strategi keuangan berkelanjutan menunjukkan ketahanan yang lebih baik dalam menghadapi fluktuasi ekonomi dan mampu memberikan kontribusi signifikan bagi perekonomian lokal.</p>`,
                    date: "2024-03-14",
                    author: "Tim Keuangan",
                    views: 0,
                    reactions: { ...defaultReactions },
                    comments: [
                        {
                            id: 201,
                            author: "Anggota Koperasi",
                            text: "Sangat membantu untuk pengembangan koperasi kami! üí™",
                            timestamp: "2024-03-14T09:20:00Z",
                            likes: 0,
                            liked: false
                        }
                    ]
                },
                {
                    id: 3,
                    title: "Kegiatan Rutin Bulanan Anggota Koperasi",
                    category: "kegiatan",
                    image: "https://images.unsplash.com/photo-1559028012-481c04fa702d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                    sourceUrl: "",
                    content: `<p>Kegiatan rutin bulanan anggota koperasi merupakan salah satu agenda penting untuk mempererat hubungan antar anggota dan membahas perkembangan terkini. Setiap bulan, anggota berkumpul untuk berdiskusi, berbagi informasi, dan merencanakan kegiatan mendatang.</p>
                             <h3>Agenda Kegiatan</h3>
                             <p>Dalam pertemuan rutin ini, dibahas berbagai topik penting seperti laporan keuangan bulanan, rencana kegiatan, evaluasi program, serta penyelesaian masalah yang dihadapi oleh anggota.</p>
                             <h3>Tujuan Kegiatan</h3>
                             <p>Tujuan utama dari kegiatan ini adalah untuk meningkatkan partisipasi anggota, memperkuat solidaritas, serta memastikan transparansi dalam pengelolaan koperasi.</p>`,
                    date: "2024-03-13",
                    author: "Divisi Kegiatan",
                    views: 0,
                    reactions: { ...defaultReactions },
                    comments: []
                }
            ];
        }

        // Save artikel ke localStorage
        function saveArticlesToStorage() {
            localStorage.setItem('koperasi_news_articles', JSON.stringify(articles));
            console.log('Artikel disimpan ke localStorage:', articles.length, 'artikel');
        }

        // Load reaksi dari localStorage
        function loadReactionsFromStorage() {
            articles.forEach(article => {
                const storedReactions = localStorage.getItem(`article_${article.id}_reactions`);
                if (storedReactions) {
                    article.reactions = JSON.parse(storedReactions);
                } else {
                    article.reactions = { ...defaultReactions };
                    localStorage.setItem(`article_${article.id}_reactions`, JSON.stringify(article.reactions));
                }
            });
        }

        // Load komentar dari localStorage
        function loadCommentsFromStorage() {
            articles.forEach(article => {
                const storedComments = localStorage.getItem(`article_${article.id}_comments`);
                if (storedComments) {
                    article.comments = JSON.parse(storedComments);
                } else {
                    // Jika tidak ada komentar di localStorage, gunakan komentar dari sample
                    if (!article.comments) {
                        article.comments = [];
                    }
                    localStorage.setItem(`article_${article.id}_comments`, JSON.stringify(article.comments));
                }
            });
        }

        // Filter dan tampilkan artikel
        function filterAndDisplayArticles() {
            // Filter berdasarkan kategori dan pencarian
            filteredArticles = articles.filter(article => {
                const matchesCategory = currentCategory === 'all' || article.category === currentCategory;
                const matchesSearch = currentSearch === '' || 
                                     article.title.toLowerCase().includes(currentSearch) ||
                                     (article.content && article.content.toLowerCase().includes(currentSearch));
                return matchesCategory && matchesSearch;
            });
            
            // Reset ke halaman pertama
            currentPage = 1;
            
            // Tampilkan artikel
            displayArticles();
            displayPagination();
            
            // Sembunyikan loading indicator
            document.getElementById('loading-indicator').style.display = 'none';
        }

        // Tampilkan artikel
        function displayArticles() {
            const container = document.getElementById('news-container');
            const startIndex = (currentPage - 1) * ARTICLES_PER_PAGE;
            const endIndex = startIndex + ARTICLES_PER_PAGE;
            const currentArticles = filteredArticles.slice(startIndex, endIndex);
            
            container.innerHTML = '';
            
            if (currentArticles.length === 0) {
                container.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 50px; color: var(--text-light);">
                        <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 20px;"></i>
                        <h3>Tidak ada artikel yang ditemukan</h3>
                        <p>Coba gunakan kata kunci lain atau pilih kategori berbeda</p>
                    </div>
                `;
                return;
            }
            
            currentArticles.forEach(article => {
                const date = new Date(article.date);
                const formattedDate = date.toLocaleDateString('id-ID', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                const shortContent = article.content ? 
                    article.content.replace(/<[^>]*>/g, '').substring(0, 150) + '...' : 
                    "Artikel ini tidak memiliki konten preview.";
                
                container.innerHTML += `
                    <div class="news-card" onclick="openArticle(${article.id})">
                        <div class="category-badge">${getCategoryName(article.category)}</div>
                        <div class="card-image">
                            <img src="${article.image}" alt="${article.title}" onerror="this.src='https://images.unsplash.com/photo-1551434678-e076c223a692?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                        </div>
                        <div class="card-content">
                            <h3>${article.title}</h3>
                            <p>${shortContent}</p>
                            ${article.sourceUrl ? `
                                <div class="external-source">
                                    <i class="fas fa-external-link-alt"></i> Sumber Eksternal
                                </div>
                            ` : ''}
                            <div class="card-meta">
                                <div class="card-date">
                                    <i class="far fa-calendar-alt"></i> ${formattedDate}
                                </div>
                                <div class="read-more">
                                    Baca Selengkapnya <i class="fas fa-arrow-right"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });
        }

        // Tampilkan pagination
        function displayPagination() {
            const container = document.getElementById('pagination-container');
            const totalPages = Math.ceil(filteredArticles.length / ARTICLES_PER_PAGE);
            
            if (totalPages <= 1) {
                container.innerHTML = '';
                return;
            }
            
            let paginationHTML = '';
            
            // Tombol sebelumnya
            paginationHTML += `
                <button class="page-btn ${currentPage === 1 ? 'disabled' : ''}" 
                        onclick="${currentPage > 1 ? `changePage(${currentPage - 1})` : ''}">
                    <i class="fas fa-chevron-left"></i>
                </button>
            `;
            
            // Halaman
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 1 && i <= currentPage + 1)) {
                    paginationHTML += `
                        <button class="page-btn ${i === currentPage ? 'active' : ''}" 
                                onclick="changePage(${i})">
                            ${i}
                        </button>
                    `;
                } else if (i === currentPage - 2 || i === currentPage + 2) {
                    paginationHTML += `<span class="page-dots">...</span>`;
                }
            }
            
            // Tombol berikutnya
            paginationHTML += `
                <button class="page-btn ${currentPage === totalPages ? 'disabled' : ''}" 
                        onclick="${currentPage < totalPages ? `changePage(${currentPage + 1})` : ''}">
                    <i class="fas fa-chevron-right"></i>
                </button>
            `;
            
            container.innerHTML = paginationHTML;
        }

        // Ganti halaman
        function changePage(page) {
            currentPage = page;
            displayArticles();
            displayPagination();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Filter kategori
        function filterCategory(category) {
            currentCategory = category;
            filterAndDisplayArticles();
        }

        // Buka artikel
        function openArticle(articleId) {
            const article = articles.find(a => a.id === articleId);
            if (!article) return;
            
            currentArticleId = articleId;
            
            // Update views
            article.views = (article.views || 0) + 1;
            saveArticlesToStorage();
            updateStats();
            
            // Format tanggal
            const date = new Date(article.date);
            const formattedDate = date.toLocaleDateString('id-ID', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // Tampilkan modal
            document.getElementById('modal-title').textContent = article.title;
            
            // Buat konten modal lengkap
            const modalBody = document.getElementById('modal-body-content');
            modalBody.innerHTML = createArticleContent(article, formattedDate);
            
            // Tampilkan modal
            document.getElementById('article-modal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // Setup event listeners untuk konten modal
            setupModalEventListeners();
        }

        // Buat konten artikel lengkap
        function createArticleContent(article, formattedDate) {
            const reactions = article.reactions || { ...defaultReactions };
            const totalReactions = Object.values(reactions).reduce((a, b) => a + b, 0);
            
            return `
                <img src="${article.image}" class="article-image" alt="${article.title}" 
                     onerror="this.src='https://images.unsplash.com/photo-1551434678-e076c223a692?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80'">
                
                <div class="article-meta">
                    <div class="article-category">${getCategoryName(article.category)}</div>
                    <div class="article-date">
                        <i class="far fa-calendar-alt"></i> ${formattedDate}
                    </div>
                </div>
                
                ${article.sourceUrl ? `
                    <a href="${article.sourceUrl}" target="_blank" class="article-source">
                        <i class="fas fa-external-link-alt"></i> Baca sumber asli di ${new URL(article.sourceUrl).hostname}
                    </a>
                ` : ''}
                
                <div class="article-content">
                    ${article.content || '<p>Artikel ini tidak memiliki konten.</p>'}
                </div>
                
                <!-- REACTIONS -->
                <div class="article-reactions">
                    <div class="reaction-options">
                        <button class="reaction-btn" data-reaction="like" onclick="handleReaction('like')">
                            <span class="reaction-emoji">‚ù§Ô∏è</span>
                            <span class="reaction-count" id="like-count">${reactions.like}</span>
                        </button>
                        <button class="reaction-btn" data-reaction="laugh" onclick="handleReaction('laugh')">
                            <span class="reaction-emoji">üòÜ</span>
                            <span class="reaction-count" id="laugh-count">${reactions.laugh}</span>
                        </button>
                        <button class="reaction-btn" data-reaction="wow" onclick="handleReaction('wow')">
                            <span class="reaction-emoji">üòÆ</span>
                            <span class="reaction-count" id="wow-count">${reactions.wow}</span>
                        </button>
                        <button class="reaction-btn" data-reaction="sad" onclick="handleReaction('sad')">
                            <span class="reaction-emoji">üò¢</span>
                            <span class="reaction-count" id="sad-count">${reactions.sad}</span>
                        </button>
                        <button class="reaction-btn" data-reaction="angry" onclick="handleReaction('angry')">
                            <span class="reaction-emoji">üò°</span>
                            <span class="reaction-count" id="angry-count">${reactions.angry}</span>
                        </button>
                    </div>
                    <div class="reaction-count">
                        <i class="fas fa-users"></i>
                        <span id="total-reactions">${totalReactions}</span> Reactions
                    </div>
                </div>
                
                <!-- KOMENTAR -->
                <div class="comments-section">
                    <h3><i class="fas fa-comments"></i> Komentar (<span id="comments-count">${article.comments ? article.comments.length : 0}</span>)</h3>
                    
                    <!-- INPUT KOMENTAR -->
                    <div class="comment-input-area">
                        <div class="comment-input-wrapper">
                            <div class="user-avatar" id="current-user-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="comment-input-container">
                                <textarea class="comment-input" id="comment-input" 
                                          placeholder="Tulis komentar Anda..." 
                                          rows="1"></textarea>
                                <div class="comment-input-actions">
                                    <button class="emoji-toggle" onclick="toggleEmojiPicker()">
                                        <i class="far fa-smile"></i>
                                    </button>
                                    <button class="send-comment" onclick="submitComment()">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                                <div class="emoji-picker-container" id="emoji-picker">
                                    <emoji-picker></emoji-picker>
                                </div>
                            </div>
                        </div>
                        <div class="reply-actions" id="reply-actions" style="display: none;">
                            <button class="cancel-reply-btn" onclick="cancelReply()">
                                <i class="fas fa-times"></i> Batal balas
                            </button>
                        </div>
                    </div>
                    
                    <!-- DAFTAR KOMENTAR -->
                    <div class="comments-list" id="comments-list">
                        ${article.comments && article.comments.length > 0 ? 
                            displayComments(article.comments) : 
                            '<div style="text-align: center; padding: 30px; color: var(--text-light);">Belum ada komentar. Jadilah yang pertama berkomentar!</div>'
                        }
                    </div>
                </div>
            `;
        }

        // Setup event listeners untuk modal
        function setupModalEventListeners() {
            // Setup emoji picker
            setupEmojiPicker();
            
            // Setup auto-resize untuk textarea komentar
            const commentInput = document.getElementById('comment-input');
            if (commentInput) {
                commentInput.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = (this.scrollHeight) + 'px';
                    
                    const sendBtn = document.querySelector('.send-comment');
                    if (this.value.trim().length > 0) {
                        sendBtn.classList.add('active');
                    } else {
                        sendBtn.classList.remove('active');
                    }
                });
                
                // Ctrl+Enter untuk submit
                commentInput.addEventListener('keydown', function(e) {
                    if (e.ctrlKey && e.key === 'Enter') {
                        submitComment();
                    }
                });
            }
            
            // Generate user avatar
            generateUserAvatar();
        }

        // Setup emoji picker
        function setupEmojiPicker() {
            const pickerContainer = document.getElementById('emoji-picker');
            const picker = pickerContainer.querySelector('emoji-picker');
            
            if (picker) {
                picker.addEventListener('emoji-click', event => {
                    const textarea = document.getElementById('comment-input');
                    const cursorPos = textarea.selectionStart;
                    const textBefore = textarea.value.substring(0, cursorPos);
                    const textAfter = textarea.value.substring(cursorPos);
                    textarea.value = textBefore + event.detail.unicode + textAfter;
                    textarea.focus();
                    textarea.selectionStart = textarea.selectionEnd = cursorPos + event.detail.unicode.length;
                    
                    // Trigger input event
                    textarea.dispatchEvent(new Event('input'));
                    
                    // Sembunyikan emoji picker
                    pickerContainer.classList.remove('show');
                });
            }
        }

        // Toggle emoji picker
        function toggleEmojiPicker() {
            const pickerContainer = document.getElementById('emoji-picker');
            pickerContainer.classList.toggle('show');
            
            setTimeout(() => {
                document.addEventListener('click', function closePicker(e) {
                    if (!pickerContainer.contains(e.target) && !e.target.closest('.emoji-toggle')) {
                        pickerContainer.classList.remove('show');
                        document.removeEventListener('click', closePicker);
                    }
                });
            }, 10);
        }

        // Generate user avatar
        function generateUserAvatar() {
            const avatar = document.getElementById('current-user-avatar');
            if (avatar) {
                const colors = ['#2A9D8F', '#E9C46A', '#F4A261', '#E76F51', '#457B9D'];
                const randomColor = colors[Math.floor(Math.random() * colors.length)];
                avatar.style.background = randomColor;
                
                const icons = ['fas fa-user', 'fas fa-user-tie', 'fas fa-user-graduate', 'fas fa-user-md'];
                const randomIcon = icons[Math.floor(Math.random() * icons.length)];
                avatar.innerHTML = `<i class="${randomIcon}"></i>`;
            }
        }

        // Tampilkan komentar
        function displayComments(comments) {
            let html = '';
            
            comments.forEach(comment => {
                const date = new Date(comment.timestamp);
                const formattedDate = date.toLocaleDateString('id-ID', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                html += `
                    <div class="comment-item" data-comment-id="${comment.id}">
                        <div class="comment-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="comment-content">
                            <div class="comment-header">
                                <div class="comment-author">${comment.author}</div>
                                <div class="comment-time">
                                    <i class="far fa-clock"></i> ${formattedDate}
                                </div>
                            </div>
                            <div class="comment-text">${comment.text}</div>
                            <div class="comment-actions">
                                <button class="like-btn ${comment.liked ? 'liked' : ''}" onclick="likeComment(${comment.id})">
                                    <i class="fas fa-thumbs-up"></i> Suka
                                    ${comment.likes > 0 ? `<span class="like-count">${comment.likes}</span>` : ''}
                                </button>
                                <button class="reply-btn" onclick="replyToComment(${comment.id}, '${comment.author}')">
                                    <i class="fas fa-reply"></i> Balas
                                </button>
                                <button class="delete-btn" onclick="deleteComment(${comment.id})">
                                    <i class="fas fa-trash"></i> Hapus
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            return html;
        }

        // Handle reaction
        function handleReaction(reactionType) {
            if (!currentArticleId) return;
            
            const article = articles.find(a => a.id === currentArticleId);
            if (!article) return;
            
            if (!article.reactions) {
                article.reactions = { ...defaultReactions };
            }
            
            // Tambah reaction
            article.reactions[reactionType] = (article.reactions[reactionType] || 0) + 1;
            
            // Save to localStorage
            localStorage.setItem(`article_${currentArticleId}_reactions`, JSON.stringify(article.reactions));
            saveArticlesToStorage(); // Simpan juga ke artikel utama
            
            // Update display
            const reactionBtn = event.target.closest('.reaction-btn');
            const countElement = document.getElementById(`${reactionType}-count`);
            
            if (countElement) {
                countElement.textContent = article.reactions[reactionType];
            }
            
            // Update total reactions
            const totalReactions = Object.values(article.reactions).reduce((a, b) => a + b, 0);
            document.getElementById('total-reactions').textContent = totalReactions;
            
            // Animation
            reactionBtn.classList.add('active');
            setTimeout(() => reactionBtn.classList.remove('active'), 300);
            
            // Update stats
            updateStats();
        }

        // Like comment
        function likeComment(commentId) {
            if (!currentArticleId) return;
            
            const article = articles.find(a => a.id === currentArticleId);
            if (!article || !article.comments) return;
            
            const comment = article.comments.find(c => c.id === commentId);
            if (!comment) return;
            
            if (!comment.likes) comment.likes = 0;
            if (!comment.liked) {
                comment.likes++;
                comment.liked = true;
            } else {
                comment.likes--;
                comment.liked = false;
            }
            
            // Save to localStorage
            localStorage.setItem(`article_${currentArticleId}_comments`, JSON.stringify(article.comments));
            saveArticlesToStorage(); // Simpan juga ke artikel utama
            
            // Update display
            const likeBtn = document.querySelector(`[data-comment-id="${commentId}"] .like-btn`);
            const likeCountSpan = document.querySelector(`[data-comment-id="${commentId}"] .like-count`);
            
            if (comment.liked) {
                likeBtn.classList.add('liked');
                likeBtn.innerHTML = `<i class="fas fa-thumbs-up"></i> Disuka`;
                if (comment.likes > 0) {
                    likeBtn.innerHTML += ` <span class="like-count">${comment.likes}</span>`;
                }
            } else {
                likeBtn.classList.remove('liked');
                likeBtn.innerHTML = `<i class="fas fa-thumbs-up"></i> Suka`;
                if (comment.likes > 0) {
                    likeBtn.innerHTML += ` <span class="like-count">${comment.likes}</span>`;
                }
            }
            
            // Animation
            likeBtn.classList.add('pulse-animation');
            setTimeout(() => likeBtn.classList.remove('pulse-animation'), 300);
        }

        // Reply to comment
        function replyToComment(commentId, authorName) {
            currentReplyTo = commentId;
            currentReplyAuthor = authorName;
            
            const commentInput = document.getElementById('comment-input');
            commentInput.placeholder = `Balas ${authorName}...`;
            commentInput.focus();
            
            const replyActions = document.getElementById('reply-actions');
            replyActions.style.display = 'block';
            replyActions.innerHTML = `
                <button class="cancel-reply-btn" onclick="cancelReply()">
                    <i class="fas fa-times"></i> Batal balas ${authorName}
                </button>
            `;
        }

        // Cancel reply
        function cancelReply() {
            currentReplyTo = null;
            currentReplyAuthor = null;
            
            const commentInput = document.getElementById('comment-input');
            commentInput.placeholder = 'Tulis komentar Anda...';
            
            document.getElementById('reply-actions').style.display = 'none';
        }

        // Submit comment
        function submitComment() {
            if (!currentArticleId) return;
            
            const commentInput = document.getElementById('comment-input');
            const commentText = commentInput.value.trim();
            
            if (!commentText) {
                alert('Silakan tulis komentar terlebih dahulu!');
                return;
            }
            
            const article = articles.find(a => a.id === currentArticleId);
            if (!article) return;
            
            if (!article.comments) article.comments = [];
            
            // Generate random user name
            const userNames = ['Pengunjung', 'Member Aktif', 'Pembaca Setia', 'Simpatisan', 'Anggota Koperasi'];
            const randomName = userNames[Math.floor(Math.random() * userNames.length)];
            
            const newComment = {
                id: Date.now(),
                author: randomName,
                text: commentText,
                timestamp: new Date().toISOString(),
                likes: 0,
                liked: false
            };
            
            article.comments.push(newComment);
            
            // Save to localStorage
            localStorage.setItem(`article_${currentArticleId}_comments`, JSON.stringify(article.comments));
            saveArticlesToStorage(); // Simpan juga ke artikel utama
            
            // Update display
            updateCommentsDisplay(article.comments);
            
            // Reset input
            commentInput.value = '';
            commentInput.style.height = 'auto';
            document.querySelector('.send-comment').classList.remove('active');
            cancelReply();
            
            // Update stats
            updateStats();
            
            // Scroll to new comment
            setTimeout(() => {
                const commentsList = document.getElementById('comments-list');
                commentsList.scrollTop = commentsList.scrollHeight;
            }, 100);
        }

        // Update comments display
        function updateCommentsDisplay(comments) {
            const commentsList = document.getElementById('comments-list');
            const commentsCount = document.getElementById('comments-count');
            
            commentsList.innerHTML = displayComments(comments);
            commentsCount.textContent = comments.length;
        }

        // Delete comment
        function deleteComment(commentId) {
            if (!confirm('Apakah Anda yakin ingin menghapus komentar ini?')) {
                return;
            }
            
            if (!currentArticleId) return;
            
            const article = articles.find(a => a.id === currentArticleId);
            if (!article || !article.comments) return;
            
            // Hapus komentar
            article.comments = article.comments.filter(comment => comment.id !== commentId);
            
            // Save to localStorage
            localStorage.setItem(`article_${currentArticleId}_comments`, JSON.stringify(article.comments));
            saveArticlesToStorage(); // Simpan juga ke artikel utama
            
            // Update display
            updateCommentsDisplay(article.comments);
            
            // Update stats
            updateStats();
        }

        // Tutup modal
        function closeModal() {
            document.getElementById('article-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
            currentArticleId = null;
            cancelReply();
        }

        // Dapatkan nama kategori
        function getCategoryName(category) {
            const categories = {
                'all': 'Semua',
                'rat': 'RAT',
                'ekonomi': 'Ekonomi',
                'teknologi': 'Teknologi',
                'pendidikan': 'Pendidikan',
                'program': 'Program',
                'sosial': 'Sosial',
                'kegiatan': 'Kegiatan Koperasi'
            };
            return categories[category] || category;
        }

        // Update statistik
        function updateStats() {
            // Total artikel
            document.getElementById('total-articles').textContent = articles.length;
            
            // Total komentar
            const totalComments = articles.reduce((total, article) => {
                return total + (article.comments ? article.comments.length : 0);
            }, 0);
            document.getElementById('total-comments').textContent = totalComments;
            
            // Total views
            const totalViews = articles.reduce((total, article) => {
                return total + (article.views || 0);
            }, 0);
            document.getElementById('total-views').textContent = totalViews.toLocaleString();
            
            // Log untuk debugging
            console.log('Stats updated:', {
                articles: articles.length,
                comments: totalComments,
                views: totalViews
            });
        }

        // Fungsi untuk menerima update dari admin editor - DIPERBARUI
        window.addEventListener('storage', function(event) {
            if (event.key === 'koperasi_news_articles') {
                console.log('Update diterima dari admin panel');
                loadArticlesFromStorage();
                updateStats();
                
                // Tampilkan notifikasi
                showNotification('Artikel telah diperbarui!');
            }
        });
        
        // Fungsi untuk manual refresh jika diperlukan
        window.refreshArticles = function() {
            loadArticlesFromStorage();
            updateStats();
            showNotification('Artikel direfresh!');
        };
        
        // Tambah CSS untuk animasi notifikasi
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateX(-50%) translateY(-20px);
                }
                to {
                    opacity: 1;
                    transform: translateX(-50%) translateY(0);
                }
            }
            
            .update-notification {
                animation: fadeInUp 0.3s ease;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
